version: 3

projects:
# =========================================================================
# Initial Bootstrap Setup
# =========================================================================
- name: initial-setup
  dir: Initial-setup
  workspace: default
  autoplan:
    when_modified: ["*.tf", "*.tfvars"]
    enabled: true
  apply_requirements: [approved]

# =========================================================================
# Team: team-ops
# =========================================================================
- name: team-ops-dev
  dir: terraform/teams/team-ops/dev
  workspace: default
  autoplan:
    when_modified: ["*.tf", "*.tfvars", "../../../modules/**/*.tf"]
    enabled: true
  apply_requirements: [approved]

- name: team-ops-prod
  dir: terraform/teams/team-ops/prod
  workspace: default
  autoplan:
    when_modified: ["*.tf", "*.tfvars", "../../../modules/**/*.tf"]
    enabled: true
  apply_requirements: [approved]

# =========================================================================
# Team: team-data
# =========================================================================
- name: team-data-dev
  dir: terraform/teams/team-data/dev
  workspace: default
  autoplan:
    when_modified: ["*.tf", "*.tfvars", "../../../modules/**/*.tf"]
    enabled: true
  apply_requirements: [approved]

# =========================================================================
# Global Resources
# =========================================================================
- name: global-org-policies
  dir: terraform/global/org-policies
  workspace: default
  autoplan:
    when_modified: ["*.tf", "*.tfvars", "../../modules/**/*.tf"]
    enabled: true
  apply_requirements: [approved]
